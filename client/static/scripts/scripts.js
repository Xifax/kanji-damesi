(function(){"use strict";angular.module("clientApp",["drahak.hotkeys","timer"])}).call(this),function(){"use strict";angular.module("clientApp").controller("MainCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("clientApp").controller("QuizCtrl",["$scope","$http","$document","$timeout","$hotkey",function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(h="/saiban/api/",g=1,b.show={bigKanji:!0,example:!1,groupKey:!0,stats:!0,ok:!1,no:!1},b.timerActive=!0,b.session={correct:0,wrong:0,total:0,answerExp:0,totalExp:0,averageTime:0,totalTime:0},b.ponderingTime=0,b.profile={streak:0,experience:0,level:0,points:1,multiplier:100},b.currentKanji={front:"?",radicals:[{front:"?"}]},b.selectedKanji={},b.skippedKanji=!1,b.quiz={readings:{kun:"?",on:"?",nanori:"?",examples:["?"]},meanings:"?",answer:"?"},b.timer={began:0,answered:0},b.kanjiLog=[],b.logLimit=b.baseLimit=3,n=15,b.groupsSeen=[],b.activeGroup={kanji:[]},t=1;5>=t;t++)b.activeGroup.kanji.push({front:"?"});return b.loading=!1,k=function(a){return b.show[a]=!0,e(function(){return b.show[a]=!1},700)},i=function(a){return console.log(a)},r=function(a){return console.log(a)},l=function(a){return k(a?"ok":"no")},p=function(a){var b,c,d;for(c=a.length;c;)b=Math.floor(Math.random()*c--),d=a[c],a[c]=a[b],a[b]=d;return a},o=function(a){return"?"!==b.activeGroup.kanji[0].front&&b.groupsSeen.push(b.activeGroup),b.activeGroup=a.group,p(b.activeGroup.kanji),b.currentKanji={front:"?",radicals:[{front:"?"}]},b.quiz=a.quiz,console.log(a.profile),console.log(b.profile),b.session.totalExp+=b.session.answerExp,b.profile=a.profile,b.timerActive?b.$broadcast("timer-start"):b.ponderingTime=0},q=function(){return b.loading=!0},j=function(){return b.loading=!1},s=function(a,c,d){return b.kanjiLog.push({answered:a,answer:b.quiz.answer,examples:b.quiz.examples,correct:c,skipped:d,toggled:!1})},m=function(){return s(b.quiz.answer,!1,!0)},b.getRandomGroup=function(){var a;return q(),a=c.get(h+"random-group"),a.success(function(a){return o(a),j()}),a.error(function(a){return i(a),j()})},b.getNextGroup=function(){var a;return q(),a=c.get(h+"next-group/"),a.success(function(a){return o(a),j()}),a.error(function(a){return i(a),j()})},b.answerWith=function(d){var e,f,k,m,n,r,t,u,v,w,x,y,z,A,B;if(!b.loading)return b.$broadcast("timer-stop"),b.selectedKanji=d,q(),e=d.front===b.quiz.answer.front,e?(u=b.ponderingTime,a.call(function(){for(y=[],m=0;3999>=m;m++)y.push(m);return y}.apply(this),u)>=0?k=4:(v=b.ponderingTime,a.call(function(){for(z=[],n=4e3;9999>=n;n++)z.push(n);return z}.apply(this),v)>=0?k=3:(w=b.ponderingTime,a.call(function(){for(A=[],r=1e4;19999>=r;r++)A.push(r);return A}.apply(this),w)>=0?k=2:(x=b.ponderingTime,k=a.call(function(){for(B=[],t=2e4;39999>=t;t++)B.push(t);return B}.apply(this),x)>=0?1:0))),b.session.answerExp=(b.activeGroup.level+b.profile.streak+b.profile.level+k)*g):b.session.answerExp=0,l(e),e?b.session.correct+=1:b.session.wrong+=1,b.session.total+=1,b.session.averageTime=b.session.totalTime/b.session.total,f=c.post(h+"answer/",{correct:e,delay:b.ponderingTime,kanji:b.quiz.answer.front}),f.success(function(a){return p(b.quiz.answer.compounds),p(d.compounds),s(d,e,!1),o(a),j()}),f.error(function(a){return i(a),j()})},b.skipQuestion=function(a){var d;if(!b.loading)return b.skippedKanji=!0,q(),d=c.post(h+"skip/",{kanji:a.front}),d.success(function(a){return m(),o(a),b.skippedKanji=!1,j()}),d.error(function(a){return i(a),j()})},b.zoomKanji=function(a){return b.currentKanji=a},b.toggleLogItemInfo=function(a){return a.toggled=!a.toggled,a.toggled?(b.timerActive=!1,b.$broadcast("timer-stop")):b.kanjiLog.every(function(a){return!a.toggled})?(b.timerActive=!0,b.$broadcast("timer-resume")):void 0},b.toggleLimit=function(){return b.logLimit=b.logLimit===b.baseLimit?n:b.baseLimit},b.toNextLevel=function(){return(b.profile.level+1)*b.profile.multiplier},b.progressExp=function(){return{width:b.profile.experience/b.toNextLevel()*100+"%"}},b.isSelected=function(a){return b.selectedKanji===a},b.pauseResumeTimer=function(){return b.$broadcast(b.timerActive?"timer-stop":"timer-resume"),b.timerActive=!b.timerActive},[1,2,3,4,5].map(function(a){return f.bind(""+a,function(){return b.answerWith(b.activeGroup.kanji[a-1])})}),f.bind("S",function(){return b.skipQuestion(b.quiz.answer)}),b.$on("timer-stopped",function(a,c){return b.ponderingTime=c.millis,b.session.totalTime+=c.millis}),b.getNextGroup()}]),angular.module("clientApp").filter("reverse",function(){return function(a){return a.slice().reverse()}})}.call(this),function(){"use strict";angular.module("clientApp").controller("UserCtrl",["$scope","$http",function(a,b){var c;return c="/saiban/api/",a.level=0,a.description="",a.getLevel=function(){var d;return d=b.get(c+"get-level/"),d.success(function(b){return a.level=b.level,a.description=b.description})},a.changeLevel=function(d){var e;return a.level=d,e=b.post(c+"change-level/",{level:d}),e.success(function(b){return a.level=b.level,a.description=b.description})},a.kanjiStatus={},a.showInfo=function(d){var e;return e=b.get(""+c+"get-kanji/"+d+"/"),e.success(function(b){return a.kanjiStatus=b,$("#kanjiInfo").modal("show")})},a.getLevel()}])}.call(this);