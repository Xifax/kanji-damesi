(function(){"use strict";angular.module("clientApp",["drahak.hotkeys","timer"])}).call(this),function(){"use strict";angular.module("clientApp").controller("MainCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("clientApp").controller("QuizCtrl",["$scope","$http","$document","$timeout","$hotkey",function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(g="/saiban/api/",f=1,a.show={bigKanji:!0,example:!1,groupKey:!0,stats:!0,ok:!1,no:!1},a.timerActive=!0,a.session={correct:0,wrong:0,total:0,answerExp:0,totalExp:0,averageTime:0,totalTime:0},a.ponderingTime=0,a.profile={streak:0,experience:0,level:0,points:1,multiplier:100},a.currentKanji={front:"?",radicals:[{front:"?"}]},a.selectedKanji={},a.skippedKanji=!1,a.quiz={readings:{kun:"?",on:"?",nanori:"?",examples:["?"]},meanings:"?",answer:"?"},a.timer={began:0,answered:0},a.kanjiLog=[],a.logLimit=a.baseLimit=3,m=15,a.groupsSeen=[],a.activeGroup={kanji:[]},s=1;5>=s;s++)a.activeGroup.kanji.push({front:"?"});return a.loading=!1,j=function(b){return a.show[b]=!0,d(function(){return a.show[b]=!1},700)},h=function(a){return console.log(a)},q=function(a){return console.log(a)},k=function(a){return j(a?"ok":"no")},o=function(a){var b,c,d;for(c=a.length;c;)b=Math.floor(Math.random()*c--),d=a[c],a[c]=a[b],a[b]=d;return a},n=function(b){return"?"!==a.activeGroup.kanji[0].front&&a.groupsSeen.push(a.activeGroup),a.activeGroup=b.group,o(a.activeGroup.kanji),a.currentKanji={front:"?",radicals:[{front:"?"}]},a.quiz=b.quiz,0!==a.profile.experience&&0!==b.profile.experience&&(a.session.answerExp=b.profile.experience-a.profile.experience),a.session.totalExp+=a.session.answerExp,a.profile=b.profile,a.timerActive?a.$broadcast("timer-start"):a.ponderingTime=0},p=function(){return a.loading=!0},i=function(){return a.loading=!1},r=function(b,c,d){return a.kanjiLog.push({answered:b,answer:a.quiz.answer,examples:a.quiz.examples,correct:c,skipped:d,toggled:!1})},l=function(){return r(a.quiz.answer,!1,!0)},a.getRandomGroup=function(){var a;return p(),a=b.get(g+"random-group"),a.success(function(a){return n(a),i()}),a.error(function(a){return h(a),i()})},a.getNextGroup=function(){var a;return p(),a=b.get(g+"next-group/"),a.success(function(a){return n(a),i()}),a.error(function(a){return h(a),i()})},a.answerWith=function(c){var d,e;if(!a.loading)return a.$broadcast("timer-stop"),a.selectedKanji=c,p(),d=c.front===a.quiz.answer.front,a.session.answerExp=d?(a.activeGroup.level+a.profile.streak+a.profile.level+4)*f:0,k(d),d?a.session.correct+=1:a.session.wrong+=1,a.session.total+=1,a.session.averageTime=a.session.totalTime/a.session.total,e=b.post(g+"answer/",{correct:d,delay:a.ponderingTime,kanji:a.quiz.answer.front}),e.success(function(b){return o(a.quiz.answer.compounds),o(c.compounds),r(c,d,!1),n(b),i()}),e.error(function(a){return h(a),i()})},a.skipQuestion=function(c){var d;if(!a.loading)return a.skippedKanji=!0,p(),d=b.post(g+"skip/",{kanji:c.front}),d.success(function(b){return l(),n(b),a.skippedKanji=!1,i()}),d.error(function(a){return h(a),i()})},a.zoomKanji=function(b){return a.currentKanji=b},a.toggleLogItemInfo=function(b){return b.toggled=!b.toggled,b.toggled?(a.timerActive=!1,a.$broadcast("timer-stop")):a.kanjiLog.every(function(a){return!a.toggled})?(a.timerActive=!0,a.$broadcast("timer-resume")):void 0},a.toggleLimit=function(){return a.logLimit=a.logLimit===a.baseLimit?m:a.baseLimit},a.toNextLevel=function(){return(a.profile.level+1)*a.profile.multiplier},a.progressExp=function(){return{width:a.profile.experience/a.toNextLevel()*100+"%"}},a.isSelected=function(b){return a.selectedKanji===b},a.pauseResumeTimer=function(){return a.$broadcast(a.timerActive?"timer-stop":"timer-resume"),a.timerActive=!a.timerActive},[1,2,3,4,5].map(function(b){return e.bind(""+b,function(){return a.answerWith(a.activeGroup.kanji[b-1])})}),e.bind("S",function(){return a.skipQuestion(a.quiz.answer)}),a.$on("timer-stopped",function(b,c){return a.ponderingTime=c.millis,a.session.totalTime+=c.millis}),a.getNextGroup()}]),angular.module("clientApp").filter("reverse",function(){return function(a){return a.slice().reverse()}})}.call(this),function(){"use strict";angular.module("clientApp").controller("UserCtrl",["$scope","$http",function(a,b){var c;return c="/saiban/api/",a.level=0,a.description="",a.getLevel=function(){var d;return d=b.get(c+"get-level/"),d.success(function(b){return a.level=b.level,a.description=b.description})},a.changeLevel=function(d){var e;return a.level=d,e=b.post(c+"change-level/",{level:d}),e.success(function(b){return a.level=b.level,a.description=b.description})},a.kanjiStatus={},a.showInfo=function(d){var e;return e=b.get(""+c+"get-kanji/"+d+"/"),e.success(function(b){return a.kanjiStatus=b,$("#kanjiInfo").modal("show")})},a.getLevel()}])}.call(this);